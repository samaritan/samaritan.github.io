<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="robots" content="noindex">
    <title>Samaritan | Metrics | Number of Outputs</title>
    <link rel="icon" href="/favicon.png" type="image/png" />
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans" type="text/css" />
    <link rel="stylesheet" href="/assets/styles/global.css" type="text/css" />
    <link rel="stylesheet" href="//stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
      integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <a class="navbar-brand" href="/">
        <img src="/assets/images/logo.svg" height="30" alt="" />
      </a>
      <ul class="navbar-nav">
        <li class="nav-item active">
          <a class="nav-link" href="/metrics/">Metrics</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/about/">About</a>
        </li>
      </ul>
    </nav>

    <div class="container">
<!-- Metric -->
<div class="row">
  <div class="col-lg-12">
    <h1 id="definition">Number of Outputs</h1>

    <p>The number of functions that a function calls.</p>

    <h2 id="interpretation">Interpretation</h1>

    <p>The attribute that number of outputs is expected to quantify is <i>testability</i>. A file that is difficult to exhaustively test is likely to have a high value for the number of outputs metric.</p>
  </div>
</div>

<!-- Evidence -->
<div class="row">
  <div class="col-lg-12">
    <div>
      <h1 id="evidence">Evidence</h1>

      <p>Number of Outputs has been empirically-validated to be associated with historical vulnerabilities in
        software in the following peer-reviewed research studies:</p>

      <ol>
        
        
        <li>To Fear or Not to Fear That is the Question: Code Characteristics of a Vulnerable Function with an Existing Exploit <a href="#Younis2016Fear">[2]</a></li>
        
      </ol>

      <p class="alert alert-warning">The empirical evidence overwhelming supports the notion that a source code file with high number of outputs is more likely to contain a security vulnerability.</p>
    </div>
  </div>
</div><!-- Evidence -->

<!-- Implication -->
<div class="row">
  <div class="col-lg-12">
    <div>
      <h1 id="implication">Implications</h1>

      <p>The security implication(s) of a file having high number of outputs could be one or more of the following:</p>

      <ul>
      
        <li>Difficulty in exhaustively testing a file may increase the potential for latent vulnerabilities.</li>
      
      </ul>
    </div>
  </div>
</div><!-- Implication -->

<!-- Mitigations -->
<div class="row">
  <div class="col-lg-12">
    <div>
      <h1 id="mitigations">Mitigations</h1>

      <p>The theoretical mitigation to lowering the number of outputs of a file is to have functions in source code files call, or be dependent on, fewer other functions. However, the theoretical mitigation is not practical because modern software is inherently complex requiring functions to call other functions to implement features. Therefore, the risk of latent vulnerabilities in a file with high number of outputs could be mitigated using one or more of the following suggestions:</p>

      <ul>
      
        <li>Refactor functions in the file to call fewer other functions when possible leveraging common design patterns as appropriate.</li>
      
        <li>Leverage automated testing to ensure all functions are appropriately tested to a satisfactory level of exhaustiveness.</li>
      
      </ul>
    </div>
  </div>
</div><!-- Mitigations -->

<!-- Implementation -->
<div class="row">
  <div class="col-lg-12">
    <div>
      <h1 id="implementation">Implementation</h1>

      <p>In our implementation of the metric, we use <a href="//scitools.com/" target="_blank">SciTools Understand™</a> to collect the number of outputs metric from functions. The metric is aggregated at the file level by computing the sum of the number of outputs of all functions in a file.</p>

      <p>The source code of the implementation of the metric will be made available on GitHub. If you need to collect
        the metric from your project, the implementation will also be made available as a container image on Docker
        Hub.</p>
    </div>
  </div>
</div><!-- Implementation -->

<!-- Examples -->
<div class="row">
  <div class="col-lg-12">
    <div>
      <h1 id="examples">Example(s)</h1>

      <p>In this section, we present examples of the  metric collected from popular open-source
        software projects.</p>

      <h2>Chromium</h2>

      <p>In this subsection, we present examples of the  metric collected from the <a
        href="https://www.chromium.org/Home" target="_blank">Chromium</a>, the open-source project behind the
        <a href="https://www.google.com/chrome/" target="_blank">Google Chrome</a> web browser.</p>

      <p>The metric examples presented here were collected at <a
        href="https://chromium.googlesource.com/chromium/src.git/+/6b9bf768231fa5f7ff3712b9bed23e57c52440eb"><code>
        6b9bf768231f</code></a> commit to the <code>master</code> branch of the Chromium source code repository.</p>

      <h3>Summary</h3>

      <div class="row">
        <div class="col-lg-2"></div>
        <div class="col-lg-4 text-center">
          <figure class="figure border rounded">
            <img src="/assets/images/metrics/noutput/chromium/distribution.svg"
              class="figure-img rounded mx-auto d-block" alt="Chromium Number of Outputs Distribution"
              style="width: 100%;" />
            <figcaption class="figure-caption font-weight-bold bg-light text-center">Figure 1</figcaption>
          </figure>
        </div>
        <div class="col-lg-4 text-center">
          <figure class="figure border rounded">
            <img src="/assets/images/metrics/noutput/chromium/discriminatory.svg"
              class="figure-img rounded mx-auto d-block" alt="Chromium Number of Outputs Discriminatory"
              style="width: 100%;" />
            <figcaption class="figure-caption font-weight-bold bg-light text-center">Figure 2</figcaption>
          </figure>
        </div>
        <div class="col-sm-2"></div>
      </div>

      <p>Shown in Figure 1 is the distribution of the  metric collected from source code files in
        the Chromium project. Shown in Figure 2 is the comparison of the distribution of the  metric
        collected from source code files in the Chromium project that were not historically vulnerable and those
        that were.</p>

      <h3>Thresholds</h3>

      <p>The thresholds of the  metric in the Chromium project determined using the approach
        prescribed by Alves <i>et al.</i> <a href="#Alves2010Deriving">
        [1]</a> is shown in the table below.</p>

      <div class="row justify-content-center">
        <div class="col-lg-12">
          <table class="table table-bordered text-center">
            <tr>
              <th class="text-left">
                Metric Range
              </th>
              <th>
                value &lt; 319
              </th>
              <th>
                319 ≤ value &lt; 554
              </th>
              <th>
                554 ≤ value &lt; 1,222
              </th>
              <th>
                1,222 ≤ value
              </th>
            </tr>
            <tr>
              <th class="text-left">Risk Level</th>
              <td class="table-secondary">Low</td>
              <td class="table-info">Medium</td>
              <td class="table-warning">High</td>
              <td class="table-danger">Critical</td>
            </tr>
          </table>
        </div>
      </div>

      <h3>Risky Files</h3>

      <p>The thresholds are used to classify source code files into appropriate risk levels. Shown below are the
        top and bottom three source code files from the Chromium project in each of the three non-trivial risk
        levels.</p>

      <div class="accordion" id="riskyFiles">
        
        <div class="card">
          <div class="card-header" id="mediumRiskHeader">
            <h2 class="mb-0">
              <button class="btn btn-link" type="button" data-toggle="collapse"
                data-target="#mediumRiskBody" aria-expanded="true"
                aria-controls="mediumRiskBody">
                Medium Risk
              </button>
            </h2>
          </div>
          <div id="mediumRiskBody" class="collapse show"
            aria-labelledby="mediumRiskHeader" data-parent="#riskyFiles">
            <div class="card-body">
              <table class="table table-bordered">
                <thead class="thead-light">
                  <tr>
                    <th>Path</th>
                    <th>Number of Outputs</th>
                    <th>Percentile</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><code>chrome/browser/ui/views/page_info/page_info_bubble_view_browsertest.cc</code></td>
                    <td class="text-right">319</td>
                    <td class="text-right">70.0488</td>
                  </tr>
                
                  <tr>
                    <td><code>third_party/tcmalloc/chromium/src/profiledata.h</code></td>
                    <td class="text-right">319</td>
                    <td class="text-right">70.0488</td>
                  </tr>
                
                  <tr>
                    <td><code>components/sync_sessions/session_store_unittest.cc</code></td>
                    <td class="text-right">319</td>
                    <td class="text-right">70.0488</td>
                  </tr>
                
                  <td colspan=3>...</td>
                
                  <tr>
                    <td><code>third_party/sqlite/sqlite-src-3280000/src/where.c</code></td>
                    <td class="text-right">552</td>
                    <td class="text-right">79.9817</td>
                  </tr>
                
                  <tr>
                    <td><code>chrome/browser/profiles/profile_manager_unittest.cc</code></td>
                    <td class="text-right">552</td>
                    <td class="text-right">79.9817</td>
                  </tr>
                
                  <tr>
                    <td><code>chrome/browser/browsing_data/cookies_tree_model.h</code></td>
                    <td class="text-right">553</td>
                    <td class="text-right">79.9912</td>
                  </tr>
                
                </tbody>
              </table>
            </div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header" id="highRiskHeader">
            <h2 class="mb-0">
              <button class="btn btn-link" type="button" data-toggle="collapse"
                data-target="#highRiskBody" aria-expanded="true"
                aria-controls="highRiskBody">
                High Risk
              </button>
            </h2>
          </div>
          <div id="highRiskBody" class="collapse"
            aria-labelledby="highRiskHeader" data-parent="#riskyFiles">
            <div class="card-body">
              <table class="table table-bordered">
                <thead class="thead-light">
                  <tr>
                    <th>Path</th>
                    <th>Number of Outputs</th>
                    <th>Percentile</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><code>third_party/sqlite/patched/src/where.c</code></td>
                    <td class="text-right">554</td>
                    <td class="text-right">80.0878</td>
                  </tr>
                
                  <tr>
                    <td><code>chrome/browser/page_load_metrics/observers/from_gws_page_load_metrics_observer_unittest.cc</code></td>
                    <td class="text-right">557</td>
                    <td class="text-right">80.1114</td>
                  </tr>
                
                  <tr>
                    <td><code>third_party/abseil-cpp/absl/container/internal/raw_hash_set_test.cc</code></td>
                    <td class="text-right">558</td>
                    <td class="text-right">80.1619</td>
                  </tr>
                
                  <td colspan=3>...</td>
                
                  <tr>
                    <td><code>third_party/sqlite/patched/ext/fts5/fts5_index.c</code></td>
                    <td class="text-right">1,161</td>
                    <td class="text-right">89.8892</td>
                  </tr>
                
                  <tr>
                    <td><code>chrome/browser/ui/views/tabs/tab_strip.h</code></td>
                    <td class="text-right">1,171</td>
                    <td class="text-right">89.8981</td>
                  </tr>
                
                  <tr>
                    <td><code>chrome/renderer/net/net_error_helper_core_unittest.cc</code></td>
                    <td class="text-right">1,195</td>
                    <td class="text-right">89.9609</td>
                  </tr>
                
                </tbody>
              </table>
            </div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header" id="criticalRiskHeader">
            <h2 class="mb-0">
              <button class="btn btn-link" type="button" data-toggle="collapse"
                data-target="#criticalRiskBody" aria-expanded="true"
                aria-controls="criticalRiskBody">
                Critical Risk
              </button>
            </h2>
          </div>
          <div id="criticalRiskBody" class="collapse"
            aria-labelledby="criticalRiskHeader" data-parent="#riskyFiles">
            <div class="card-body">
              <table class="table table-bordered">
                <thead class="thead-light">
                  <tr>
                    <th>Path</th>
                    <th>Number of Outputs</th>
                    <th>Percentile</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><code>chrome/browser/sync/test/integration/two_client_bookmarks_sync_test.cc</code></td>
                    <td class="text-right">1,222</td>
                    <td class="text-right">90.0207</td>
                  </tr>
                
                  <tr>
                    <td><code>content/browser/webauth/authenticator_impl_unittest.cc</code></td>
                    <td class="text-right">1,238</td>
                    <td class="text-right">90.2554</td>
                  </tr>
                
                  <tr>
                    <td><code>third_party/sqlite/sqlite-src-3280000/ext/fts2/fts2.c</code></td>
                    <td class="text-right">1,238</td>
                    <td class="text-right">90.2554</td>
                  </tr>
                
                  <td colspan=3>...</td>
                
                  <tr>
                    <td><code>third_party/wtl/include/atlwince.h</code></td>
                    <td class="text-right">8,567</td>
                    <td class="text-right">96.6272</td>
                  </tr>
                
                  <tr>
                    <td><code>third_party/libxml/src/testapi.c</code></td>
                    <td class="text-right">11,115</td>
                    <td class="text-right">97.6838</td>
                  </tr>
                
                  <tr>
                    <td><code>third_party/sqlite/amalgamation/sqlite3.c</code></td>
                    <td class="text-right">14,612</td>
                    <td class="text-right">100</td>
                  </tr>
                
                </tbody>
              </table>
            </div>
          </div>
        </div>
        
      </div>
    </div>
  </div>
</div><!-- Examples -->


<!-- References -->
<div class="row">
  <div class="col-lg-12">
    <div>
      <h1 id="references">Reference(s)</h1>
      
      <p id="Alves2010Deriving">[1] Tiago L. Alves, Christiaan Ypma, and Joost Visser. 2010. Deriving Metric Thresholds From Benchmark Data.
        In Proceedings of the 26th International Conference on Software Maintenance (ICSM '10). 1-10. <a href="https://doi.org/10.1109/ICSM.2010.5609747" target="_blank">https://doi.org/10.1109/ICSM.2010.5609747</a>
      
      <p id="Younis2016Fear">[2] Awad Younis, Yashwant Malaiya, Charles Anderson, and Indrajit Ray. 2016. To Fear or Not to Fear That is the Question: Code Characteristics of a Vulnerable Function with an Existing Exploit.
        In Proceedings of the 6th ACM Conference on Data and Application Security and Privacy (CODASPY '16). New York, NY, USA, 97–104. <a href="https://doi.org/10.1145/2857705.2857750" target="_blank">https://doi.org/10.1145/2857705.2857750</a>
      
    </div>
  </div>
</div><!-- References -->

    </div>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
  integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
  integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
  integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

  </body>
</html>